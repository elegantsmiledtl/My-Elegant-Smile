(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[154],{11186:(e,s,t)=>{"use strict";t.d(s,{bq:()=>h,eb:()=>j,gC:()=>p,l6:()=>o,yv:()=>m});var a=t(95155),r=t(12115),i=t(4729),l=t(59007),n=t(42614),d=t(72251),c=t(64269);let o=i.bL;i.YJ;let m=i.WT,h=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(i.l9,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[r,(0,a.jsx)(i.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=i.l9.displayName;let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.PP,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})});u.displayName=i.PP.displayName;let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.wn,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})});x.displayName=i.wn.displayName;let p=r.forwardRef((e,s)=>{let{className:t,children:r,position:l="popper",...n}=e;return(0,a.jsx)(i.ZL,{children:(0,a.jsxs)(i.UC,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...n,children:[(0,a.jsx)(u,{}),(0,a.jsx)(i.LM,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(x,{})]})})});p.displayName=i.UC.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.JU,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=i.JU.displayName;let j=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(i.q7,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(i.VF,{children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})}),(0,a.jsx)(i.p4,{children:r})]})});j.displayName=i.q7.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=i.wv.displayName},18516:(e,s,t)=>{"use strict";t.d(s,{Toaster:()=>f});var a=t(95155),r=t(15894),i=t(12115),l=t(65476),n=t(83101),d=t(26615),c=t(64269);let o=l.Kq,m=i.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.LM,{ref:s,className:(0,c.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...r})});m.displayName=l.LM.displayName;let h=(0,n.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),u=i.forwardRef((e,s)=>{let{className:t,variant:r,...i}=e;return(0,a.jsx)(l.bL,{ref:s,className:(0,c.cn)(h({variant:r}),t),...i})});u.displayName=l.bL.displayName,i.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.rc,{ref:s,className:(0,c.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...r})}).displayName=l.rc.displayName;let x=i.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.bm,{ref:s,className:(0,c.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...r,children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})});x.displayName=l.bm.displayName;let p=i.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.hE,{ref:s,className:(0,c.cn)("text-sm font-semibold",t),...r})});p.displayName=l.hE.displayName;let j=i.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.VY,{ref:s,className:(0,c.cn)("text-sm opacity-90",t),...r})});function f(){let{toasts:e}=(0,r.dj)();return(0,a.jsxs)(o,{children:[e.map(function(e){let{id:s,title:t,description:r,action:i,...l}=e;return(0,a.jsxs)(u,{...l,children:[(0,a.jsxs)("div",{className:"grid gap-1",children:[t&&(0,a.jsx)(p,{children:t}),r&&(0,a.jsx)(j,{children:r})]}),i,(0,a.jsx)(x,{})]},s)}),(0,a.jsx)(m,{})]})}j.displayName=l.VY.displayName},58209:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ee});var a=t(95155),r=t(12115),i=t(3998),l=t(27314),n=t(75283),d=t(13381),c=t(53489),o=t(15894),m=t(64269),h=t(52619),u=t.n(h),x=t(18516);function p(e){let{cases:s,setCases:t,onReload:h}=e,{toast:p}=(0,o.dj)(),j=(0,r.useRef)(null);return(0,a.jsxs)("header",{className:"bg-card border-b shadow-sm p-4",children:[(0,a.jsx)(x.Toaster,{}),(0,a.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.$,{asChild:!0,size:"sm",children:(0,a.jsxs)(u(),{href:"/owner",children:[(0,a.jsx)(l.A,{className:"mr-2 h-4 w-4"})," Owner View"]})}),(0,a.jsx)(i.$,{asChild:!0,size:"sm",variant:"secondary",children:(0,a.jsxs)(u(),{href:"/login",children:[(0,a.jsx)(n.A,{className:"mr-2 h-4 w-4"})," Doctor Portal"]})}),(0,a.jsxs)(i.$,{onClick:()=>{window.location.reload()},variant:"outline",size:"sm",children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Reload"]}),(0,a.jsx)("input",{type:"file",ref:j,onChange:e=>{var s;let a=null==(s=e.target.files)?void 0:s[0];if(a){let e=new FileReader;e.onload=e=>{try{var s;let a=null==(s=e.target)?void 0:s.result,r=JSON.parse(a,(e,s)=>"createdAt"===e&&"string"==typeof s?new Date(s):s);if(Array.isArray(r)&&r.every(e=>e.id&&e.patientName))t(r),p({title:"Success",description:"Successfully imported cases from JSON file."});else throw Error("Invalid JSON file format.")}catch(e){p({variant:"destructive",title:"Import Failed",description:e instanceof Error?e.message:"Could not parse the JSON file."})}},e.readAsText(a)}e.target&&(e.target.value="")},accept:".json",className:"hidden"}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{if(0===s.length)return void p({variant:"destructive",title:"No Data",description:"There are no cases to export."});try{let e=(0,m.j7)(s);(0,m.PE)(e,"elegant-smile-data.csv","text/csv"),p({title:"Export Successful",description:"Cases have been exported to CSV."})}catch(e){p({variant:"destructive",title:"Export Failed",description:"Could not convert data to CSV."})}},children:[(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4"})," Export CSV"]})]}),(0,a.jsx)("div",{className:"flex-1 flex justify-end items-center gap-2"})]})]})}var j=t(41307),f=t(26991),g=t(94632),v=t(68425),w=t(47734),N=t(73697),y=t(23508),b=t(26736),C=t(86948),A=t(40671),S=t(37736),D=t(57268);let k=r.forwardRef((e,s)=>{let{className:t,orientation:r="horizontal",decorative:i=!0,...l}=e;return(0,a.jsx)(D.b,{ref:s,decorative:i,orientation:r,className:(0,m.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",t),...l})});function E(e){let{cases:s}=e,t=(0,r.useMemo)(()=>{if(!s)return{totalTeeth:0,totalRevenue:0,casesByDentist:[],materialUsage:[],teethByMaterial:[]};let e=s.reduce((e,s)=>(e[s.dentistName]=(e[s.dentistName]||0)+1,e),{}),t=s.reduce((e,s)=>(s.material.split(",").map(e=>e.trim()).filter(e=>e).forEach(s=>{e[s]=(e[s]||0)+1}),e),{}),a=s.reduce((e,s)=>{let t=s.toothNumbers.split(",").filter(e=>""!==e.trim()).length;return s.material.split(",").map(e=>e.trim()).filter(e=>e).forEach(s=>{e[s]=(e[s]||0)+t}),e},{});return{totalTeeth:s.reduce((e,s)=>e+s.toothNumbers.split(",").filter(e=>""!==e.trim()).length,0),totalRevenue:s.reduce((e,s)=>e+(s.totalAmount||0),0),casesByDentist:Object.entries(e).map(e=>{let[s,t]=e;return{name:s,cases:t}}),materialUsage:Object.entries(t).map(e=>{let[s,t]=e;return{name:s,count:t}}),teethByMaterial:Object.entries(a).map(e=>{let[s,t]=e;return{name:s,units:t}})}},[s]);return 0===s.length?null:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(C.Zp,{children:[(0,a.jsx)(C.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,a.jsx)(C.ZB,{className:"text-sm font-medium",children:"Filtered Cases Summary"})}),(0,a.jsx)(C.Wu,{children:(0,a.jsxs)("div",{className:"flex flex-col space-y-6 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[(0,a.jsx)(A.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Total Revenue"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[t.totalRevenue.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})," JOD"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"From all filtered cases"})]}),(0,a.jsx)(k,{}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[(0,a.jsx)(S.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Total Units"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:t.totalTeeth}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Across all filtered cases"})]})]})})]}),(0,a.jsxs)(C.Zp,{className:"lg:col-span-2",children:[(0,a.jsx)(C.aR,{children:(0,a.jsx)(C.ZB,{children:"Cases per Dentist"})}),(0,a.jsx)(C.Wu,{children:(0,a.jsx)(f.u,{width:"100%",height:200,children:(0,a.jsxs)(g.E,{data:t.casesByDentist,children:[(0,a.jsx)(v.d,{strokeDasharray:"3 3"}),(0,a.jsx)(w.W,{dataKey:"name",fontSize:12,tickLine:!1,axisLine:!1}),(0,a.jsx)(N.h,{fontSize:12,tickLine:!1,axisLine:!1}),(0,a.jsx)(y.m,{}),(0,a.jsx)(b.y,{dataKey:"cases",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),(0,a.jsxs)(C.Zp,{children:[(0,a.jsx)(C.aR,{children:(0,a.jsx)(C.ZB,{children:"Case Count by Material"})}),(0,a.jsx)(C.Wu,{children:(0,a.jsx)(f.u,{width:"100%",height:300,children:(0,a.jsxs)(g.E,{data:t.materialUsage,layout:"vertical",children:[(0,a.jsx)(v.d,{strokeDasharray:"3 3"}),(0,a.jsx)(w.W,{type:"number"}),(0,a.jsx)(N.h,{type:"category",dataKey:"name",width:80,fontSize:12,tickLine:!1,axisLine:!1}),(0,a.jsx)(y.m,{}),(0,a.jsx)(b.y,{dataKey:"count",fill:"hsl(var(--accent))",radius:[0,4,4,0]})]})})})]}),(0,a.jsxs)(C.Zp,{children:[(0,a.jsx)(C.aR,{children:(0,a.jsx)(C.ZB,{children:"Unit Count by Material"})}),(0,a.jsx)(C.Wu,{children:(0,a.jsx)(f.u,{width:"100%",height:300,children:(0,a.jsxs)(g.E,{data:t.teethByMaterial,layout:"vertical",children:[(0,a.jsx)(v.d,{strokeDasharray:"3 3"}),(0,a.jsx)(w.W,{type:"number"}),(0,a.jsx)(N.h,{type:"category",dataKey:"name",width:80,fontSize:12,tickLine:!1,axisLine:!1}),(0,a.jsx)(y.m,{}),(0,a.jsx)(b.y,{dataKey:"units",fill:"hsl(var(--secondary))",radius:[0,4,4,0]})]})})})]})]})}k.displayName=D.b.displayName;var R=t(65142),M=t(42997),L=t(88964),F=t(13630),U=t(59915),z=t(54715),I=t(5320),O=t(6943),P=t(14585),$=t(51834),q=t(87270),T=t(76444),Z=t(76604),B=t(19456),J=t(87754),W=t(98053),G=t(22544),V=t(11186);let K=["Zolid","Zirconia","Nickel Free","N-Guard","Implant","MookUp"],Y={Zolid:25,Zirconia:30,"Nickel Free":20,"N-Guard":15,Implant:50,MookUp:10},_="owner_app_auth";function H(){let[e,s]=(0,r.useState)([]),{toast:t}=(0,o.dj)();return(0,r.useEffect)(()=>{(async()=>{try{let e=await (0,P.Te)();s(e)}catch(e){console.error("Firebase Error:",e),t({variant:"destructive",title:"Database Error",description:"Could not fetch login logs."})}})()},[t]),(0,a.jsxs)($.Cf,{children:[(0,a.jsxs)($.c7,{children:[(0,a.jsx)($.L3,{children:"User Login History"}),(0,a.jsx)($.rr,{children:"This is a list of all successful logins to the doctor portal."})]}),(0,a.jsx)("div",{className:"rounded-md border mt-4 max-h-[60vh] overflow-y-auto",children:(0,a.jsxs)(q.XI,{children:[(0,a.jsx)(q.A0,{children:(0,a.jsxs)(q.Hj,{children:[(0,a.jsx)(q.nd,{children:"Doctor User"}),(0,a.jsx)(q.nd,{children:"Login Time"})]})}),(0,a.jsx)(q.BF,{children:e.map(e=>(0,a.jsxs)(q.Hj,{children:[(0,a.jsx)(q.nA,{className:"font-medium",children:e.dentistName}),(0,a.jsx)(q.nA,{children:(e=>{if(!e)return"N/A";let s=e.toDate?e.toDate():new Date(e);if(!(0,B.f)(s))return"Invalid Date";try{return(0,J.qD)(s,"Asia/Amman","PPP p")}catch(e){return"Invalid Date"}})(e.timestamp)})]},e.id))})]})})]})}function X(e){let{user:s,onUserUpdated:t,onCancel:l}=e,{register:n,handleSubmit:d,formState:{errors:c}}=(0,G.mN)({defaultValues:{name:s.name,password:"",welcomeMessage:s.welcomeMessage}}),{toast:m}=(0,o.dj)(),[h,u]=(0,r.useState)(!1),x=async e=>{u(!0);try{let a={name:e.name,welcomeMessage:e.welcomeMessage};e.password&&(a.password=e.password),await (0,P.TK)(s.id,a),m({title:"Success",description:"User has been updated."}),t()}catch(e){m({variant:"destructive",title:"Error",description:e.message})}finally{u(!1)}};return(0,a.jsxs)("form",{onSubmit:d(x),className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(T.J,{htmlFor:"name",children:"Doctor User"}),(0,a.jsx)(R.p,{id:"name",...n("name",{required:"Name is required"})}),c.name&&(0,a.jsx)("p",{className:"text-destructive text-sm mt-1",children:c.name.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(T.J,{htmlFor:"password",children:"New Password (optional)"}),(0,a.jsx)(R.p,{id:"password",type:"password",...n("password"),placeholder:"Leave blank to keep unchanged"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(T.J,{htmlFor:"welcomeMessage",children:"Welcome Message"}),(0,a.jsx)(R.p,{id:"welcomeMessage",...n("welcomeMessage")})]}),(0,a.jsxs)($.Es,{children:[(0,a.jsx)(i.$,{type:"button",variant:"outline",onClick:l,children:"Cancel"}),(0,a.jsx)(i.$,{type:"submit",disabled:h,children:h?"Saving...":"Save Changes"})]})]})}function Q(e){let{onUserAdded:s,onCancel:t}=e,{register:l,handleSubmit:n,formState:{errors:d}}=(0,G.mN)(),{toast:c}=(0,o.dj)(),[m,h]=(0,r.useState)(!1),u=async e=>{h(!0);try{await (0,P.nu)(e),c({title:"Success",description:"New doctor has been added."}),s()}catch(e){c({variant:"destructive",title:"Error",description:e.message})}finally{h(!1)}};return(0,a.jsxs)("form",{onSubmit:n(u),className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(T.J,{htmlFor:"add-name",children:"Doctor User"}),(0,a.jsx)(R.p,{id:"add-name",...l("name",{required:"Name is required"})}),d.name&&(0,a.jsx)("p",{className:"text-destructive text-sm mt-1",children:d.name.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(T.J,{htmlFor:"add-password",children:"Password"}),(0,a.jsx)(R.p,{id:"add-password",type:"password",...l("password",{required:"Password is required"})}),d.password&&(0,a.jsx)("p",{className:"text-destructive text-sm mt-1",children:d.password.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(T.J,{htmlFor:"add-welcomeMessage",children:"Welcome Message (optional)"}),(0,a.jsx)(R.p,{id:"add-welcomeMessage",...l("welcomeMessage"),placeholder:"e.g. Welcome, Dr. Smith"})]}),(0,a.jsxs)($.Es,{children:[(0,a.jsx)(i.$,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),(0,a.jsx)(i.$,{type:"submit",disabled:m,children:m?"Adding...":"Add Doctor"})]})]})}function ee(){let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(!1),[n,d]=(0,r.useState)(""),[c,m]=(0,r.useState)("all"),{toast:h}=(0,o.dj)(),[x,f]=(0,r.useState)([]),[g,v]=(0,r.useState)([]),[w,N]=(0,r.useState)(!1),[y,b]=(0,r.useState)(""),[A,D]=(0,r.useState)(""),[k,B]=(0,r.useState)([]),[J,G]=(0,r.useState)(!1),[ee,es]=(0,r.useState)(!1),[et,ea]=(0,r.useState)(null),er=!!et,ei=async()=>{try{let e=await (0,P.lo)();B(e)}catch(e){ed(e)}};(0,r.useEffect)(()=>{J&&ei()},[J]);let el=async e=>{try{await (0,P.hG)(e),h({title:"Success",description:"User has been deleted."}),ei()}catch(e){ed(e)}};(0,r.useEffect)(()=>{l(!0),"true"===localStorage.getItem(_)&&N(!0)},[]);let en=async()=>{try{let e=await (0,P.Eh)();s(e)}catch(e){ed(e)}};(0,r.useEffect)(()=>{w&&en()},[w]),(0,r.useEffect)(()=>{let e=async()=>{if(w)try{let e=(await (0,P.AX)("owner")).filter(e=>!0);e.length>0&&f(e)}catch(e){console.error("Failed to check for owner notifications:",e)}};t&&e()},[w,t,e]);let ed=e=>{console.error("Firebase Error:",e);let s="An unexpected error occurred.";"permission-denied"===e.code||e.message&&e.message.includes("permission-denied")?s="You have insufficient permissions to access the database. Please update your Firestore security rules in the Firebase console.":e.message&&(s=e.message),h({variant:"destructive",title:"Database Error",description:s,action:s.includes("insufficient permissions")?(0,a.jsx)("a",{href:"https://console.firebase.google.com/project/elegant-smile-r6jex/firestore/rules",target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(i.$,{variant:"secondary",children:"Fix Rules"})}):void 0})},ec=async e=>{try{["Dr.Ibraheem Omar","Dr.Mahmod Mishael"].includes(e.dentistName)?(await (0,P.Gm)(e.id,{isDeleted:!0}),h({title:"Case Hidden",description:"Case has been hidden from the owner view but remains in the doctor's backup."})):(await (0,P.CH)(e.id),h({title:"Success",description:"Case deleted successfully."})),en()}catch(e){ed(e)}},eo=async e=>{try{await (0,P.Gm)(e.id,e),s(s=>s.map(s=>s.id===e.id?e:s)),h({title:"Success",description:"Case updated successfully."})}catch(e){ed(e)}},em=async(e,s,t)=>{if(!s)return void h({variant:"destructive",title:"Error",description:"Notification is missing a case ID."});let a=await (0,P.tT)(s);if(!a)return void h({variant:"destructive",title:"Error",description:"Could not find the related case."});try{t?(await (0,P.Gm)(s,{isDeleted:!0,deletionRequested:!0}),await (0,P.UI)(a.dentistName,"Your deletion request for case (".concat(a.patientName,") was APPROVED.")),h({title:"Approved",description:"Case has been marked as deleted."})):(await (0,P.Gm)(s,{deletionRequested:!1}),await (0,P.UI)(a.dentistName,"Your deletion request for case (".concat(a.patientName,") was DENIED.")),h({title:"Denied",description:"Case deletion request has been denied."})),await (0,P.bA)(e),f(s=>s.filter(s=>s.id!==e)),en()}catch(e){ed(e)}},eh=async()=>{try{let s=e.filter(e=>g.includes(e.id)).map(e=>["Dr.Ibraheem Omar","Dr.Mahmod Mishael"].includes(e.dentistName)?(0,P.Gm)(e.id,{isDeleted:!0}):(0,P.CH)(e.id));await Promise.all(s),h({title:"Cases Action Completed",description:"".concat(g.length," selected case(s) have been processed.")}),en(),v([])}catch(e){ed(e)}},eu=(0,r.useMemo)(()=>e.filter(e=>{if(e.isDeleted)return!1;let s=e.dentistName.toLowerCase().includes(n.toLowerCase())||e.patientName.toLowerCase().includes(n.toLowerCase()),t="all"===c||e.material.includes(c);return s&&t}).map(e=>{var s,t;let a=e.material.split(",")[0].trim(),r=null!=(t=null!=(s=e.unitPrice)?s:Y[a])?t:0,i=e.toothNumbers.split(",").filter(e=>""!==e.trim()).length;return{...e,unitPrice:r,totalAmount:r*i}}),[e,n,c]);return t?w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.Lt,{open:x.length>0,onOpenChange:e=>!e&&f([]),children:(0,a.jsxs)(W.EO,{children:[(0,a.jsx)(W.wd,{children:(0,a.jsxs)(W.r7,{children:["You have ",x.length," new notification(s)"]})}),(0,a.jsx)("div",{className:"list-disc pl-5 space-y-2 mt-2 max-h-60 overflow-y-auto pr-4",children:x.map(e=>(0,a.jsxs)("div",{className:"font-bold text-foreground py-2 border-b last:border-b-0",children:[(0,a.jsx)("p",{children:e.message}),e.message.includes("delete")&&e.caseId?(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsx)(i.$,{size:"sm",onClick:()=>em(e.id,e.caseId,!0),children:"Yes, Delete"}),(0,a.jsx)(i.$,{size:"sm",variant:"destructive",onClick:()=>em(e.id,e.caseId,!1),children:"No, Keep"})]}):(0,a.jsx)("div",{className:"flex gap-2 mt-2"})]},e.id))}),(0,a.jsx)(W.ck,{children:(0,a.jsx)(W.Rx,{onClick:()=>{x.forEach(e=>{var s;e.message.includes("delete")||(s=e.id,(0,P.bA)(s),f(e=>e.filter(e=>e.id!==s)))}),f(e=>e.filter(e=>e.message.includes("delete")))},children:"Got It"})})]})}),(0,a.jsx)($.lG,{open:J,onOpenChange:G,children:(0,a.jsxs)($.Cf,{className:"max-w-3xl",children:[(0,a.jsxs)($.c7,{children:[(0,a.jsx)($.L3,{children:"Manage Users"}),(0,a.jsx)($.rr,{children:"Add, edit, or delete doctor accounts."})]}),(0,a.jsx)("div",{className:"my-4",children:(0,a.jsxs)(i.$,{onClick:()=>es(!0),children:[(0,a.jsx)(M.A,{className:"mr-2 h-4 w-4"})," Add New Doctor"]})}),(0,a.jsx)("div",{className:"rounded-md border max-h-[50vh] overflow-y-auto",children:(0,a.jsxs)(q.XI,{children:[(0,a.jsx)(q.A0,{children:(0,a.jsxs)(q.Hj,{children:[(0,a.jsx)(q.nd,{children:"Doctor User"}),(0,a.jsx)(q.nd,{children:"Password"}),(0,a.jsx)(q.nd,{children:"Welcome Message"}),(0,a.jsx)(q.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(q.BF,{children:k.map(e=>(0,a.jsxs)(q.Hj,{children:[(0,a.jsx)(q.nA,{className:"font-medium",children:e.name}),(0,a.jsx)(q.nA,{children:e.password}),(0,a.jsx)(q.nA,{children:e.welcomeMessage}),(0,a.jsxs)(q.nA,{className:"text-right",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>ea(e),children:(0,a.jsx)(L.A,{className:"h-4 w-4"})}),(0,a.jsxs)(W.Lt,{children:[(0,a.jsx)(W.tv,{asChild:!0,children:(0,a.jsx)(i.$,{variant:"ghost",size:"icon",children:(0,a.jsx)(F.A,{className:"h-4 w-4 text-destructive"})})}),(0,a.jsxs)(W.EO,{children:[(0,a.jsxs)(W.wd,{children:[(0,a.jsx)(W.r7,{children:"Are you sure?"}),(0,a.jsxs)(W.$v,{children:["This will permanently delete ",e.name,"'s account."]})]}),(0,a.jsxs)(W.ck,{children:[(0,a.jsx)(W.Zr,{children:"Cancel"}),(0,a.jsx)(W.Rx,{onClick:()=>el(e.id),className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})]})]},e.id))})]})})]})}),(0,a.jsx)($.lG,{open:ee,onOpenChange:es,children:(0,a.jsxs)($.Cf,{children:[(0,a.jsx)($.c7,{children:(0,a.jsx)($.L3,{children:"Add New Doctor"})}),(0,a.jsx)(Q,{onUserAdded:()=>{es(!1),ei()},onCancel:()=>es(!1)})]})}),(0,a.jsx)($.lG,{open:er,onOpenChange:e=>!e&&ea(null),children:(0,a.jsxs)($.Cf,{children:[(0,a.jsx)($.c7,{children:(0,a.jsxs)($.L3,{children:["Edit User: ",null==et?void 0:et.name]})}),et&&(0,a.jsx)(X,{user:et,onUserUpdated:()=>{ea(null),ei()},onCancel:()=>ea(null)})]})}),(0,a.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,a.jsx)(p,{cases:e,setCases:s,onReload:en}),(0,a.jsxs)("main",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,a.jsx)(E,{cases:eu}),(0,a.jsxs)(C.Zp,{className:"shadow-lg",children:[(0,a.jsx)(C.aR,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("div",{className:"flex justify-between items-start",children:(0,a.jsxs)(C.ZB,{className:"flex items-center gap-2 font-headline",children:[(0,a.jsx)(S.A,{className:"w-6 h-6 text-primary"}),"All Recorded Cases"]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 items-start",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(W.Lt,{children:[(0,a.jsx)(W.tv,{asChild:!0,children:(0,a.jsxs)(i.$,{variant:"destructive",size:"sm",disabled:0===g.length,children:[(0,a.jsx)(F.A,{className:"mr-2 h-4 w-4"}),"Delete (",g.length,")"]})}),(0,a.jsxs)(W.EO,{children:[(0,a.jsxs)(W.wd,{children:[(0,a.jsx)(W.r7,{children:"Are you absolutely sure?"}),(0,a.jsxs)(W.$v,{children:["This action cannot be undone. This will permanently delete ",g.length," selected case(s). Cases for Dr.Ibraheem Omar will be hidden from this view but remain in his backup."]})]}),(0,a.jsxs)(W.ck,{children:[(0,a.jsx)(W.Zr,{children:"Cancel"}),(0,a.jsx)(W.Rx,{onClick:eh,className:"bg-destructive hover:bg-destructive/90",children:"Yes, process"})]})]})]}),(0,a.jsxs)($.lG,{children:[(0,a.jsx)($.zM,{asChild:!0,children:(0,a.jsxs)(i.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(U.A,{className:"mr-2 h-4 w-4"}),"Logs"]})}),(0,a.jsx)($.Cf,{children:(0,a.jsx)(H,{})})]}),(0,a.jsx)(i.$,{asChild:!0,variant:"outline",size:"sm",children:(0,a.jsxs)(u(),{href:"/owner/invoice",children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4"}),"Invoices"]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.$,{asChild:!0,variant:"outline",size:"sm",children:(0,a.jsxs)(u(),{href:"/owner/qr",children:[(0,a.jsx)(I.A,{className:"mr-2 h-4 w-4"}),"QR Code"]})}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>G(!0),children:[(0,a.jsx)(O.A,{className:"mr-2 h-4 w-4"}),"Manage Users"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:ml-auto",children:[(0,a.jsx)(R.p,{placeholder:"Search by dentist or patient...",value:n,onChange:e=>d(e.target.value),className:"max-w-xs"}),(0,a.jsxs)(V.l6,{value:c,onValueChange:m,children:[(0,a.jsx)(V.bq,{className:"w-[180px]",children:(0,a.jsx)(V.yv,{placeholder:"Filter by material..."})}),(0,a.jsxs)(V.gC,{children:[(0,a.jsx)(V.eb,{value:"all",children:"All Materials"}),K.map(e=>(0,a.jsx)(V.eb,{value:e,children:e},e))]})]})]})]})]})}),(0,a.jsx)(C.Wu,{children:(0,a.jsx)(j.A,{cases:eu,onDeleteCase:ec,onUpdateCase:eo,selectedCases:g,onSelectedCasesChange:v,showSerialNumber:!0})})]})]})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute top-8 left-8",children:(0,a.jsx)(Z.default,{})}),(0,a.jsxs)(C.Zp,{className:"w-full max-w-sm shadow-2xl",children:[(0,a.jsxs)(C.aR,{children:[(0,a.jsx)(C.ZB,{className:"text-2xl",children:"Owner Dashboard Access"}),(0,a.jsx)(C.BT,{children:"Please enter the password to continue."})]}),(0,a.jsx)(C.Wu,{children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"Ahmad0903"===y?(localStorage.setItem(_,"true"),N(!0),D("")):D("Incorrect password. Please try again.")},className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(T.J,{htmlFor:"password",children:"Password"}),(0,a.jsx)(R.p,{id:"password",type:"password",required:!0,value:y,onChange:e=>b(e.target.value)})]}),A&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:A}),(0,a.jsx)(i.$,{type:"submit",className:"w-full",children:"Enter"})]})})]})]}):null}},81653:(e,s,t)=>{Promise.resolve().then(t.bind(t,58209))}},e=>{e.O(0,[992,481,368,524,746,312,498,88,782,476,794,665,689,307,441,255,358],()=>e(e.s=81653)),_N_E=e.O()}]);